\input{figures/Architecture}

% Use tight spacing around the title of the section

\vspace*{-0.5em}

\section{Language-Independent Smell Detection}~\label{sec:approach}

\vspace*{-1em}

% Give the basic definitions of the code smells
% Motivate why we picked these code smells
% Note: only four out of the five code smells that
% developers care about are implemented in TreeNose

{\bf Definitions}.Bearing in mind both the top 15 most common code smells
reported by developers~\cite{developersCare} and those smells commonly detected
by existing tools for Java, JavaScript, and Python, we designed
\texttt{TreeNose} to detect these code smells:

\begin{itemize}[leftmargin=*]
	%
	\item \textbf{Complex Conditional (CC)}~\cite{Fowler_Beck}: occurs when a
	      conditional clause contains too many conditions, such as nested {\tt
			      if-else} statements, and long {\tt switch-case} statements.
	      %
	\item \textbf{Long Class (LC)}~\cite{Fowler_Beck}: a class handles too much
	      work. Normally it occurs with too many properties. Or a class has too
	      many lines because of the extremely long properties.
	      %
	\item \textbf{Long Method (LM)}~\cite{Fowler_Beck}: a method grows too long.
	      Normally it occurs with too many lines of code. The longer a method is,
	      the harder it is to understand the procedure.
	      %
	\item \textbf{Long Message Chain (LMC)}~\cite{Fowler_Beck}: a long chain of
	      object calls. This smell occurs when a method or an attribute calls
	      another method or an attribute, and so on.
	      %
	\item \textbf{Long Parameter List (LPL)}~\cite{Fowler_Beck}: a method or a
	      function has too many parameters. When a method has too many parameters,
	      it often indicates that the method is doing too much work.
	      %
\end{itemize}

{\bf Detection Technique}. \texttt{TreeNose} adopts AST-based approach to detect
code smells. The Fig.~\ref{fig:architecture} discloses the architecture of
\texttt{TreeNose}. \texttt{TreeNose} executes 3 steps to detect target code
smells. 1. Extract source code from the project, 2. Parse the source code to
AST, 3. Analyze AST to detect code smells.

\textbf{Step 1: Extract Source Code}: \texttt{TreeNose} recursively extracts
source code matching with the target programming language from the
project. During this procedure, \texttt{TreeNose} fetches all target files
unless the file or the path is in the ignore list.

\textbf{Step 2: Parse Source Code to AST}: \texttt{TreeNose} parses the source
code to AST with Treesitter \cite{treeSitter}. Treesitter is a parser generator
tool that generates AST in multiple programming languages. It currently
supports 18 language bindings. Treesitter decouples the parser from the
language grammar, making it possible to parse the source code in multiple
programming languages.

\textbf{Step 3: Analyze AST to Detect Code Smells}: \texttt{TreeNose} analyzes
AST to detect code smells. Before the analysis, our developers categorize the
language-specific Treesitter AST nodes like method and function across
programming languages into language-independent groups. This categorization
enables \texttt{TreeNose} to execute the same detection process for nodes in
the same group across multiple programming languages. During the analysis,
\texttt{TreeNose} queries AST and searches for the associated components in
AST. When locating the components, \texttt{TreeNose} calculates the metrics
against the thresholds. Table~\ref{tab:metrics-and-thresholds} shows the
detection metrics with default thresholds for each code smell. Finally,
\texttt{TreeNose} generates reports with the list of code smells detected in
the project.

\input{tables/metric_table}
